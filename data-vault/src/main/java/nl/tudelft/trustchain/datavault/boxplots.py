# Import libraries
import matplotlib.pyplot as plt
import numpy as np


def encr_results():
    points = [x * 10 for x in range(1, 101)]
    cbc = [
        x / 1000
        for x in [
            88,
            60,
            76,
            94,
            118,
            133,
            148,
            166,
            187,
            203,
            222,
            240,
            270,
            278,
            296,
            314,
            333,
            351,
            371,
            402,
            406,
            424,
            451,
            462,
            499,
            507,
            519,
            540,
            552,
            577,
            591,
            611,
            627,
            644,
            663,
            688,
            735,
            757,
            742,
            770,
            792,
            797,
            825,
            831,
            855,
            869,
            887,
            915,
            929,
            946,
            966,
            980,
            1000,
            1013,
            1034,
            1053,
            1073,
            1095,
            1113,
            1127,
            1147,
            1170,
            1185,
            1202,
            1212,
            1233,
            1258,
            1278,
            1294,
            1308,
            1327,
            1344,
            1368,
            1396,
            1405,
            1421,
            1444,
            1458,
            1497,
            1497,
            1505,
            1528,
            1549,
            1572,
            1588,
            1602,
            1663,
            1663,
            1705,
            1675,
            1700,
            1720,
            1787,
            1754,
            1767,
            1805,
            1805,
            1830,
            1839,
            1868,
        ]
    ]
    ctr = [
        x / 1000
        for x in [
            27,
            46,
            42,
            47,
            52,
            61,
            69,
            78,
            88,
            96,
            163,
            115,
            192,
            202,
            142,
            150,
            158,
            167,
            175,
            184,
            192,
            338,
            349,
            362,
            422,
            394,
            253,
            258,
            271,
            274,
            466,
            479,
            498,
            311,
            317,
            358,
            362,
            345,
            355,
            365,
            374,
            380,
            390,
            399,
            403,
            412,
            424,
            436,
            439,
            448,
            458,
            470,
            476,
            481,
            492,
            500,
            509,
            519,
            528,
            537,
            547,
            556,
            561,
            564,
            572,
            582,
            594,
            611,
            624,
            616,
            628,
            636,
            642,
            654,
            661,
            677,
            683,
            691,
            700,
            718,
            710,
            721,
            730,
            740,
            743,
            769,
            769,
            785,
            781,
            794,
            804,
            810,
            833,
            836,
            832,
            841,
            846,
            859,
            866,
            921,
        ]
    ]

    fig = plt.figure(figsize=(10, 7))
    fig.suptitle("CTR vs CBC encryption", fontsize=14, fontweight="bold")

    ax = fig.add_subplot()

    ax.plot(
        points, cbc, "r--", points, ctr, "b--", points, cbc, "r.", points, ctr, "b."
    )
    ax.axis([0, 1000, 0, 2.5])

    ax.set_xlabel("MB")
    ax.set_ylabel("Seconds")

    plt.show()


def decr_results():
    points = [x * 10 for x in range(1, 101)]
    cbc = [
        x / 1000
        for x in [
            122,
            51,
            72,
            60,
            74,
            84,
            92,
            102,
            117,
            124,
            135,
            146,
            157,
            167,
            181,
            190,
            200,
            331,
            224,
            237,
            246,
            261,
            272,
            301,
            461,
            310,
            316,
            325,
            338,
            351,
            361,
            565,
            380,
            386,
            406,
            413,
            425,
            436,
            446,
            460,
            467,
            474,
            497,
            504,
            513,
            526,
            532,
            550,
            557,
            573,
            575,
            589,
            604,
            606,
            616,
            633,
            643,
            659,
            666,
            675,
            1016,
            708,
            709,
            722,
            737,
            741,
            759,
            768,
            776,
            787,
            803,
            821,
            817,
            845,
            851,
            1330,
            1359,
            880,
            886,
            898,
            914,
            939,
            928,
            936,
            960,
            1502,
            987,
            1006,
            999,
            998,
            1017,
            1047,
            1054,
            1050,
            1057,
            1073,
            1111,
            1110,
            1120,
            1128,
        ]
    ]
    ctr = [
        x / 1000
        for x in [
            64,
            33,
            37,
            56,
            56,
            61,
            71,
            80,
            91,
            97,
            110,
            114,
            125,
            131,
            143,
            152,
            159,
            167,
            176,
            184,
            197,
            204,
            215,
            220,
            230,
            238,
            249,
            256,
            432,
            455,
            278,
            286,
            295,
            506,
            313,
            323,
            337,
            338,
            349,
            355,
            365,
            371,
            384,
            393,
            401,
            407,
            420,
            426,
            435,
            445,
            451,
            464,
            470,
            474,
            482,
            496,
            854,
            520,
            519,
            536,
            538,
            549,
            554,
            569,
            579,
            587,
            592,
            603,
            610,
            624,
            629,
            632,
            640,
            662,
            666,
            668,
            679,
            691,
            696,
            704,
            712,
            724,
            728,
            741,
            745,
            754,
            768,
            833,
            781,
            785,
            806,
            814,
            816,
            836,
            841,
            1402,
            857,
            867,
            873,
            890,
        ]
    ]

    fig = plt.figure(figsize=(10, 7))
    fig.suptitle("CTR vs CBC decryption", fontsize=14, fontweight="bold")

    ax = fig.add_subplot()

    ax.plot(
        points, cbc, "r--", points, ctr, "b--", points, cbc, "ro", points, ctr, "bo"
    )
    ax.axis([0, 1000, 0, 2])

    ax.set_xlabel("MB")
    ax.set_ylabel("Seconds")

    plt.show()


def matrix(a, b):
    result = []
    for x in a:
        for y in b:
            result.append(x + y)
    return result


def ac_verification_results():
    access_verification = 3
    transfer_speed = [1553, 1568, 1675, 1964]
    transfer_speed_prime = [1530, 1598, 1610, 1675, 1890]
    tcid = [0, 1, 1, 2]
    ebsi = [253, 255, 285, 350]

    ts_mean = np.mean(transfer_speed_prime)
    ts_std = np.std(transfer_speed_prime)

    np.random.seed(23)
    rand_ts = np.random.normal(ts_mean, ts_std, 5)
    # print(np.random.normal(ts_mean, ts_std, 5))

    no_ver = [1731.2173587, 1553.99507121, 1761.70323018, 1595.89155109, 1686.24472596]
    tcid_ts = [
        1614.95392095,
        1786.89431232,
        1588.01983542,
        1786.02733512,
        1690.54875109,
    ]
    ebsi_ts = [1571.15642809, 1615.17628684, 1690.54875109, 1520.02618, 1661.1838234]

    data = [
        transfer_speed,
        no_ver,
        matrix(tcid_ts, tcid),
        matrix(ebsi_ts, ebsi),
    ]

    fig = plt.figure(figsize=(10, 7))
    ax = fig.add_subplot()
    ax.boxplot(data)
    ax.set_title("File request speed (500kB)")
    # ax.set_xlabel('xlabel')
    ax.set_ylabel("Milliseconds")
    ax.set_xticks([1, 2, 3, 4], ["Baseline", "Session token", "TCID", "EBSI VC"])

    # Creating plot
    # plt.boxplot(data)

    # show plot
    plt.show()


ST = "SESSION_TOKEN"
TCID = "TCID"
EBSI = "JWT"
BASELINE = "JSONLD"


def to_sec(data):
    return [x / 1000 for x in data]


def single_test():
    res = {
        "SESSION_TOKEN": [
            # 3899,
            690,
            974,
            813,
            964,
            737,
            950,
            648,
            918,
            767,
            # 1358,
            690,
            891,
            643,
            1247,
            941,
            # 8713,
            # 4494,
            # 1642,
            755,
            897,
            804,
            # 1855,
            711,
            # 4902,
        ],
        "TCID": [
            # 2391,
            1845,
            1752,
            # 4541,
            2180,
            1699,
            # 2610,
            1671,
            1576,
            1517,
            1609,
            2297,
            2024,
            1565,
            1776,
            2084,
            1377,
            1421,
            1774,
            1609,
            1624,
            1556,
            1556,
            1578,
            1890,
        ],
        "JWT": [
            # 1513,
            1232,
            1061,
            # 1769,
            1067,
            1415,
            1158,
            1272,
            1121,
            # 4564,
            1096,
            # 1787,
            1106,
            1340,
            1015,
            1582,
            1082,
            1107,
            1071,
            1022,
            1194,
            # 5132,
            959,
            1092,
            1096,
        ],
        "JSONLD": [
            702,
            1127,
            # 1456,
            # 5324,
            793,
            1175,
            # 1405,
            893,
            976,
            1163,
            941,
            1198,
            696,
            691,
            736,
            1270,
            729,
            762,
            734,
            724,
            733,
            # 5522,
            1085,
            691,
            676,
        ],
    }
    return res


def single_test_4g():
    res = {
        "SESSION_TOKEN": [
            2996,
            3467,
            2559,
            2707,
            2680,
            3098,
            6875,
            3447,
            2588,
            2777,
            2951,
            3160,
            2424,
            2214,
            2307,
            2457,
            2272,
            3578,
            2379,
            2850,
            3276,
            3698,
            2548,
            3064,
            4037,
        ],
        "TCID": [
            6723,
            8124,
            8333,
            8051,
            7491,
            6602,
            6882,
            7155,
            8012,
            7710,
            8425,
            9147,
            8716,
            8165,
            7308,
            9181,
            8863,
            10726,
            10619,
            10238,
            9391,
            10648,
            10939,
            10188,
            16704,
        ],
        "JWT": [
            4340,
            4180,
            4419,
            4337,
            4673,
            2658,
            4783,
            4881,
            2507,
            3301,
            3278,
            5424,
            5350,
            4482,
            13583,
            11725,
            10898,
            7477,
            3992,
            2823,
            3261,
            2426,
            5245,
            3783,
            3321,
        ],
        "JSONLD": [
            2907,
            3707,
            9361,
            6276,
            3465,
            4874,
            6041,
            3978,
            1721,
            5072,
            5017,
            3979,
            2916,
            5842,
            4601,
            2454,
            3377,
            4037,
            5154,
            2451,
            1756,
            4316,
            4275,
            6147,
            4800,
        ],
    }
    return res


def double_5_1():
    res = {
        "SESSION_TOKEN": [
            1833,
            6316,
            2008,
            4704,
            2033,
            4234,
            1653,
            6093,
            1751,
            1458,
            2026,
            1467,
            1313,
            8873,
            4807,
            1654,
            4901,
            1216,
            5974,
            1513,
            4946,
            6207,
            1798,
            4922,
            1126,
        ],
        "TCID": [
            2880,
            2813,
            3153,
            3106,
            3236,
            3199,
            5258,
            2686,
            2884,
            3621,
            3173,
            8366,
            5028,
            5190,
            4731,
            4371,
            5346,
            6178,
            5647,
            5594,
            5185,
            4584,
            6470,
            6305,
            8141,
        ],
        "JWT": [
            3615,
            1155,
            2660,
            1063,
            1115,
            1354,
            1489,
            990,
            1158,
            1267,
            1246,
            1113,
            1096,
            1191,
            1111,
            1708,
            1238,
            1163,
            1066,
            1304,
            1254,
            1405,
            1218,
            1708,
            1138,
        ],
        "JSONLD": [
            3707,
            1372,
            848,
            3342,
            824,
            940,
            716,
            719,
            921,
            3761,
            4044,
            1220,
            825,
            1453,
            723,
            1005,
            750,
            3439,
            750,
            969,
            762,
            1133,
            746,
            923,
            844,
        ],
    }
    return res


def ac_ver():
    res = single_test()

    data = [
        to_sec(res[BASELINE]),
        to_sec(res[ST]),
        to_sec(res[TCID]),
        to_sec(res[EBSI]),
    ]

    fig = plt.figure(figsize=(10, 7))
    ax = fig.add_subplot()
    ax.boxplot(data)
    ax.set_title("File request speed (500kB)")
    # ax.set_xlabel('xlabel')
    ax.set_ylabel("Seconds")
    ax.set_xticks([1, 2, 3, 4], ["Baseline", "Session token", "TCID", "EBSI VC"])

    # Creating plot
    # plt.boxplot(data)

    # show plot
    plt.show()


if __name__ == "__main__":
    # encr_results()
    # decr_results()
    # ac_verification_results()
    ac_ver()
